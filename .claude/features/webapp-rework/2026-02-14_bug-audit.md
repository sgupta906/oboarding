# Bug Audit Report: OnboardingHub Webapp

**Date:** 2026-02-14
**Method:** Playwright MCP walkthrough of all pages, buttons, modals, and flows
**Status:** Incomplete — user has additional findings to add

---

## CRITICAL BUGS (App is broken, can't complete core flows)

### BUG-1: Role creation fails — UUID error
- **Where:** Manager > Roles tab > Create First Role / Add New Role
- **Error:** `Failed to create role: invalid input syntax for type uuid: "system"`
- **Root cause:** The code passes the string `"system"` as `created_by` instead of a valid UUID or null. The `roles.created_by` column is `UUID REFERENCES users(id)` — it won't accept a string.
- **Impact:** TOTAL BLOCKER. Roles are required by templates, users, and new hires. Nothing in the app works without this fix.
- **Screenshot:** `audit-06-role-creation-error.png`

### BUG-2: Employee view has no navbar — user is trapped
- **Where:** Login as Employee → main page
- **What happens:** Blank white page with just "No onboarding run assigned to your email yet." centered. No navbar, no branding, no sign-out button.
- **Impact:** Employee literally cannot sign out or navigate. Must clear localStorage/cookies manually.
- **Screenshot:** `audit-17-employee-login.png`

### BUG-3: Circular dependency blocks entire manager workflow
- **Where:** All creation modals (Templates, Users, New Hires)
- **What happens:**
  - Can't create Templates → requires Roles (dropdown shows "No roles available")
  - Can't create Users → requires Roles (same warning)
  - Can't create New Hires → requires Roles AND Templates
  - Can't create Roles → UUID bug (BUG-1)
- **Result:** A fresh instance is completely unusable. Manager cannot do anything.
- **Screenshots:** `audit-10-new-hire-modal.png`, `audit-13-template-validation-error.png`, `audit-15-new-user-modal.png`

---

## UX BUGS (App works but the experience is bad)

### UX-1: Manager lands on Employee View by default
- **Where:** Login as Manager → initial page load
- **What happens:** "Employee View" toggle is active (highlighted), showing "No active onboarding instances found." yellow banner on blank page. Manager must manually click "Manager View".
- **Expected:** Manager should land on Manager View automatically.
- **Screenshot:** `audit-02-manager-landing.png`

### UX-2: Employee empty state is terrible
- **Where:** Employee view when no onboarding is assigned
- **What happens:** Completely blank white page with a single line of small gray text. No navbar, no branding, no helpful messaging.
- **Expected:** Should show navbar, sign-out button, friendly message like "Your onboarding hasn't been set up yet. Contact your manager."
- **Screenshot:** `audit-14-employee-view-empty.png`

### UX-3: Manager dashboard gives no guidance on first use
- **Where:** Manager > Dashboard tab (fresh instance)
- **What happens:** Shows KPI cards all at 0, "All caught up!" and "No activity yet" — but no indication of what to do first.
- **Expected:** Should have a "Getting Started" banner: "Create Roles → Create Templates → Add New Hires"
- **Screenshot:** `audit-03-manager-dashboard.png`

### UX-4: New Hire modal shows all fields even when prerequisites missing
- **Where:** Manager > Dashboard > "+ New Hire" button
- **What happens:** Shows full form (name, email, department, start date) but Role and Template dropdowns are disabled with red warnings. User can fill out half the form for nothing.
- **Expected:** Should show a clear "Set up roles and templates first" message with links, not a half-usable form.
- **Screenshot:** `audit-10-new-hire-modal.png`

### UX-5: Sign-in page says "Emulator Mode"
- **Where:** Sign-in page, quick login section
- **What happens:** Section header says "Quick Login (Emulator Mode):" — leftover from Firebase era.
- **Expected:** Should say "Quick Login (Dev Mode):" or "Test Accounts:" since we're on Supabase now.

### UX-6: Adding multiple template steps is tedious
- **Where:** Create Template modal > Onboarding Steps
- **What happens:** Only shows one step at a time, must click "+ Add Step" for each one. No bulk add, no reorder, no drag-and-drop.
- **User feedback:** "adding multiple steps sucks, it just takes forever"

---

## VISUAL / DARK MODE BUGS

### DARK-1: Dashboard KPI cards don't adapt to dark mode
- **Where:** Manager > Dashboard tab with dark mode enabled
- **What happens:** KPI cards (Active Onboardings, Stuck Employees, Doc Feedback), Documentation Feedback card, and Live Activity card all stay white on dark background.
- **Screenshot:** `audit-08-dark-mode-dashboard.png`

### DARK-2: Users page cards stay white in dark mode
- **Where:** Manager > Users tab with dark mode enabled
- **What happens:** Tip banner, User Administration header, and "No users yet" card all stay white.
- **Screenshot:** `audit-09-dark-mode-users.png`

### DARK-3: Dark mode is inconsistent across pages
- Templates page handles dark mode correctly (cards adapt)
- Dashboard, Roles, and Users pages don't adapt cards
- Modals always have white backgrounds (acceptable but inconsistent)
- Roles page in dark mode actually looks fine (`audit-07-dark-mode-roles.png`)

---

## MINOR ISSUES

### MINOR-1: Console 400 error on roles fetch
- `GET /rest/v1/roles?select=*` returns 400 on every page load
- Likely an RLS policy issue — anonymous user can't read the roles table

### MINOR-2: WebSocket warning on every page load
- Supabase Realtime connection fails with WebSocket error
- Expected since RLS may block it, but should be handled gracefully (not show console warnings)

### MINOR-3: "Send Sign-In Link" button is misleading
- Button exists on sign-in page but doesn't actually send emails
- It's a mock implementation — label should clarify this

---

## USER'S ADDITIONAL FINDINGS (TO BE ADDED)

The user noted this audit is missing things they've observed. They will add their own findings in a follow-up session before we start the `/research` phase.

Known items user mentioned but not fully audited yet:
- "there are bugs everywhere" — may be more beyond what was found
- "weird UI bugs and inconsistencies" — need specific examples from user
- "light/dark mode doesn't work great" — partially covered above but may be more
- "the website needs to be reworked quite a bit but sort of keep the dna that it has"

---

## PROPOSED ROADMAP

### Phase 1: Unblock the core flow (Critical)
- Fix UUID `"system"` bug in role creation service
- Fix RLS policies so app can read/write data (roles 400 error)
- Fix Employee view to show navbar + sign-out button

### Phase 2: First-run experience
- Manager lands on Manager View by default
- Add guided "Getting Started" flow: Roles → Templates → New Hire
- Better empty states on all pages
- Fix sign-in "Emulator Mode" label

### Phase 3: Dark mode + visual consistency
- Fix all cards/components to respect dark mode
- Consistent styling across all pages

### Phase 4: UX improvements
- Better template step editor (batch add, reorder)
- New Hire modal: block form when prerequisites missing
- Clean up error handling for Supabase connection failures

### Phase 5: Replace fake tests with real E2E tests
- Playwright E2E tests that walk through actual user flows
- Test the flows that the current 650 unit tests completely miss

---

## SCREENSHOTS TAKEN

All screenshots saved in project root:
- `audit-01-signin.png` — Sign-in page
- `audit-02-manager-landing.png` — Manager lands on Employee View (bug)
- `audit-03-manager-dashboard.png` — Manager Dashboard (light mode)
- `audit-04-roles-empty.png` — Roles tab empty state
- `audit-05-create-role-modal.png` — Create Role modal
- `audit-06-role-creation-error.png` — Role creation UUID error
- `audit-07-dark-mode-roles.png` — Roles in dark mode (looks ok)
- `audit-08-dark-mode-dashboard.png` — Dashboard dark mode (cards broken)
- `audit-09-dark-mode-users.png` — Users dark mode (cards broken)
- `audit-10-new-hire-modal.png` — New Hire modal with missing prerequisites
- `audit-11-templates-dark.png` — Templates dark mode (looks ok)
- `audit-12-create-template-modal.png` — Create Template modal
- `audit-13-template-validation-error.png` — Template requires roles error
- `audit-14-employee-view-empty.png` — Employee view empty (Manager logged in)
- `audit-15-new-user-modal.png` — New User modal with missing roles
- `audit-16-sign-out.png` — Sign-out flow (works correctly)
- `audit-17-employee-login.png` — Employee login: blank page, no navbar
