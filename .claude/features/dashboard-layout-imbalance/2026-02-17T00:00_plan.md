# Plan: dashboard-layout-imbalance

## Metadata
- **Feature:** dashboard-layout-imbalance (Bug #32)
- **Created:** 2026-02-17T00:00
- **Status:** plan-complete
- **Based On:** 2026-02-17T00:00_research.md

## Architecture Overview

The manager dashboard bottom section uses a CSS Grid with `grid-cols-[2fr_1fr]`:

```
ManagerView.tsx (line 290)
+----------------------------------------------------------+
| div.grid.grid-cols-1.lg:grid-cols-[2fr_1fr].gap-8       |
|                                                          |
|  +-------- 2fr ---------+  +-------- 1fr ---------+     |
|  | SuggestionsSection    |  | ActivitySection       |     |
|  |   div.space-y-4       |  |   div.space-y-3       |     |
|  |                       |  |                       |     |
|  |   [Header row]        |  |   [Header row]        |     |
|  |   [Empty Card ~150px] |  |   [ActivityFeed]      |     |
|  |   [  or sugg list   ] |  |     Card ~450px       |     |
|  |                       |  |     [header button]   |     |
|  |   <<< gap >>>         |  |     [scroll area]     |     |
|  |                       |  |     max-h-[400px]     |     |
|  +-----------------------+  +-----------------------+     |
+----------------------------------------------------------+
```

**Problem:** CSS Grid stretches cell backgrounds to equal height, but the inner content of each cell does not fill the cell. The left column's "All caught up!" card is ~150px while the right column's ActivityFeed is ~450px, creating a visual imbalance.

**Fix:** Add flexbox utilities so inner content stretches to fill the grid cell height.

```
AFTER FIX:
+----------------------------------------------------------+
| div.grid.grid-cols-1.lg:grid-cols-[2fr_1fr].gap-8       |
|                                                          |
|  +-------- 2fr ---------+  +-------- 1fr ---------+     |
|  | SuggestionsSection    |  | ActivitySection       |     |
|  |   div.space-y-4       |  |   div.space-y-3       |     |
|  |   + flex flex-col     |  |   + flex flex-col     |     |
|  |                       |  |                       |     |
|  |   [Header row]        |  |   [Header row]        |     |
|  |   [Empty Card         |  |   [ActivityFeed]      |     |
|  |    + flex-1           |  |     Card + flex-1     |     |
|  |    + flex flex-col    |  |     [header button]   |     |
|  |    + justify-center   |  |     [scroll area]     |     |
|  |                       |  |     max-h-[400px]     |     |
|  |    "All caught up!"   |  |                       |     |
|  |    centered vertically|  |                       |     |
|  |                       |  |                       |     |
|  +-----------------------+  +-----------------------+     |
+----------------------------------------------------------+
```

## Tech Stack

No additions. Pure Tailwind CSS utility changes.

## File Structure

### New Files
None.

### Modified Files

| File | Line(s) | Change |
|------|---------|--------|
| `src/components/manager/SuggestionsSection.tsx` | 49 | Add `flex flex-col` to root div class |
| `src/components/manager/SuggestionsSection.tsx` | 61 | Add `flex-1 flex flex-col justify-center` to empty-state Card class |
| `src/components/manager/SuggestionsSection.tsx` | 75 | Add `flex-1` to suggestions list div class |
| `src/components/manager/ActivitySection.tsx` | 20 | Add `flex flex-col` to root div class |
| `src/components/manager/ActivityFeed.tsx` | 69 | Add `flex-1` to Card class |

**Total: 3 files, ~5 lines changed (Tailwind class additions only)**

## Data Model Changes
None.

## Component Architecture

No structural changes. All three components retain their existing structure, props, and behavior. The only change is adding Tailwind utility classes for flex layout.

### State Management
No changes.

## Detailed Changes

### 1. SuggestionsSection.tsx

**Line 49 -- Root div:**
```tsx
// Before:
<div className="space-y-4">

// After:
<div className="space-y-4 flex flex-col">
```

**Line 61 -- Empty-state Card:**
```tsx
// Before:
<Card className="p-8 text-center">

// After:
<Card className="p-8 text-center flex-1 flex flex-col justify-center">
```

**Line 75 -- Suggestions list:**
```tsx
// Before:
<div className="space-y-3">

// After:
<div className="space-y-3 flex-1">
```

### 2. ActivitySection.tsx

**Line 20 -- Root div:**
```tsx
// Before:
<div className="space-y-3">

// After:
<div className="space-y-3 flex flex-col">
```

### 3. ActivityFeed.tsx

**Line 69 -- Card wrapper (non-empty state):**
```tsx
// Before:
<Card className="overflow-hidden flex flex-col">

// After:
<Card className="overflow-hidden flex flex-col flex-1">
```

## Testing Strategy

### Existing Tests
- No dedicated test files exist for SuggestionsSection, ActivitySection, or ActivityFeed.
- ManagerView.test.tsx has tests for SuggestionsSection step title resolution (line 518+), but these test functional behavior, not layout.

### Unit Tests (1 new test file, ~3-4 tests)
Create `src/components/manager/DashboardLayout.test.tsx` to verify the CSS classes are applied:
1. SuggestionsSection root div has `flex` and `flex-col` classes
2. SuggestionsSection empty-state Card has `flex-1`, `flex`, `flex-col`, `justify-center` classes
3. ActivitySection root div has `flex` and `flex-col` classes
4. ActivityFeed Card has `flex-1` class

### Integration Tests
None needed -- this is a CSS-only change with no logic.

### E2E / Visual Tests
None required in the automated suite. Visual verification via Playwright screenshot during implementation.

### Regression
Run full test suite (`npx vitest run`) to confirm no existing tests break.

## Implementation Notes

### Decisions
- **No changes to ManagerView.tsx grid container.** CSS Grid default `align-items: stretch` already stretches grid cells to equal height. The issue is that inner content does not fill the cell, which is fixed by adding flex utilities to the children.
- **`flex-1` on suggestions list div** ensures that when suggestions exist (not just empty state), the list also fills available height.
- **`justify-center` on empty-state Card** centers the "All caught up!" content vertically within the stretched card, rather than pinning it to the top.
- **ActivityFeed empty state Card (line 52)** is NOT modified. The empty state for ActivityFeed is a standalone return that does not participate in the flex layout of ActivitySection's normal flow. If both sections are empty, there is no height imbalance to fix.

### Patterns
- All changes follow the existing Tailwind utility class pattern.
- No dark mode impact -- flex utilities have no color/theme sensitivity.

### Trade-offs
- Adding `flex-1` to the suggestions list div means individual SuggestionCards will not stretch vertically (they are block elements inside a flex-1 container). This is intentional -- we want the list container to fill space, but cards within it remain their natural size.

## Non-Goals
- Not redesigning the grid layout proportions (2fr/1fr ratio stays).
- Not adding min-height constraints to either section.
- Not modifying the ActivityFeed `max-h-[400px]` scroll behavior.
- Not adding responsiveness changes -- mobile layout (single column) is unaffected.
- Not touching ManagerView.tsx grid container.
