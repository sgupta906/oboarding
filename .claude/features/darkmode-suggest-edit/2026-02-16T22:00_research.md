# Research: darkmode-suggest-edit

## Metadata
- **Feature:** darkmode-suggest-edit (Bug #21 from STATUS.md)
- **Created:** 2026-02-16T22:00
- **Status:** research-complete
- **Researcher:** research-agent
- **Priority:** P0 CRITICAL

## Feature Context
- **Description:** SuggestEditModal.tsx has zero `dark:` Tailwind CSS classes. When dark mode is enabled, the textarea has a white background clashing with the dark modal body (`dark:bg-slate-800`), text colors default to light-mode values making them barely visible, and validation/success banners use light-only background colors.
- **Where it fits:** This is a critical UX bug in the employee onboarding flow. Employees use the Suggest Edit modal (accessed from step cards via the "Suggest Edit" button) to provide feedback on onboarding steps. In dark mode the modal is unusable.
- **Dependencies:** None. This is a standalone CSS-only fix in a single file.
- **User-reported:** Yes. The user specifically reported invisible textarea text in dark mode.

## Requirements

### Functional Requirements
- [ ] FR1: All text in SuggestEditModal must be readable in dark mode (source: user report)
- [ ] FR2: The textarea must have appropriate dark mode background, text color, border, and placeholder color (source: user report)
- [ ] FR3: Validation messages (amber warning, emerald success) must be readable in dark mode (source: code audit)
- [ ] FR4: Footer text (character count, Cancel button) must be readable in dark mode (source: code audit)
- [ ] FR5: The component must remain fully readable and unchanged in light mode (regression safety)

### Technical Requirements
- [ ] TR1: Follow the exact same `dark:` class pattern used in CreateOnboardingModal.tsx and UserModal.tsx
- [ ] TR2: Use `slate-` palette (not `gray-`) for consistency with the rest of the app
- [ ] TR3: No new dependencies or structural changes -- purely adding `dark:` class variants
- [ ] TR4: Zero changes to component logic, only className string modifications

### Constraints
- Only file to modify: `src/components/modals/SuggestEditModal.tsx`
- No test file currently exists for SuggestEditModal

## Visual Reproduction

### Screenshots

| Screenshot | Description |
|-----------|-------------|
| `screenshots/01-dark-mode-bug-textarea-white-on-dark.png` | **BUG:** Dark mode SuggestEditModal mock showing white textarea on dark bg, dim description text, light-green success banner clashing with dark bg, barely-visible Cancel button |
| `screenshots/03-light-mode-reference-ok.png` | **REFERENCE:** Light mode SuggestEditModal mock showing everything works correctly -- readable text, appropriate colors |

### Bug Observations (from screenshot 01)
1. **Textarea:** Bright white background (`bg: white` default) on `dark:bg-slate-800` modal body -- extreme contrast clash
2. **Description text:** `text-slate-600` (#475569) on dark background -- very dim, barely readable
3. **Success banner:** `bg-emerald-50` (#ecfdf5) light green background clashes with dark modal
4. **Cancel button:** `text-slate-600` in dark footer (#334155) -- nearly invisible
5. **Character count:** `text-slate-500` in dark footer -- low contrast

## Existing Code Analysis

### Project State
- Project exists: YES
- File to fix: `/home/sanjay/Workspace/onboarding/src/components/modals/SuggestEditModal.tsx` (176 lines)
- Current `dark:` class count in file: **0** (zero)

### Dark Mode System
- **Strategy:** Tailwind `darkMode: 'class'` (see `/home/sanjay/Workspace/onboarding/tailwind.config.js` line 3)
- **Toggle mechanism:** `DarkModeContext` at `/home/sanjay/Workspace/onboarding/src/context/DarkModeContext.tsx` -- adds/removes `dark` class on `document.documentElement`, persists to localStorage
- **ModalWrapper:** At `/home/sanjay/Workspace/onboarding/src/components/ui/ModalWrapper.tsx` -- already has proper dark mode support. Provides `dark:bg-slate-800` body, `dark:border-slate-700` borders, `dark:bg-slate-700` footer, `dark:text-white` title.

### Reference Components (Proper Dark Mode)
These modals have the correct pattern to follow:

| Component | File | `dark:` count |
|-----------|------|---------------|
| CreateOnboardingModal | `src/components/modals/CreateOnboardingModal.tsx` | 43 |
| RoleModal | `src/components/modals/RoleModal.tsx` | 27 |
| UserModal | `src/components/modals/UserModal.tsx` | 24 |

### Dark Mode Pattern (from reference components)

```
// Labels
text-slate-700 dark:text-slate-200

// Helper/secondary text
text-slate-600 dark:text-slate-400
text-slate-500 dark:text-slate-400

// Input fields (normal state)
border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white

// Input fields (error state)
border-red-300 bg-red-50 dark:bg-red-900/20 dark:border-red-600

// Error text
text-red-600 dark:text-red-400

// Info banners
bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700
text-blue-900 dark:text-blue-300

// Warning banners
bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-700
text-amber-800 dark:text-amber-300

// Cancel button
text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-600
```

### Line-by-Line Fix Specification

Each className that needs a `dark:` variant, with exact line numbers from SuggestEditModal.tsx:

#### Footer Section (lines 64-112)

| Line | Current Class(es) | Add Dark Variant(s) |
|------|-------------------|---------------------|
| 66 | `text-slate-500` | `dark:text-slate-400` |
| 71 | `text-amber-600` | `dark:text-amber-400` |
| 82 | `text-slate-600 hover:text-slate-800 hover:bg-slate-100` | `dark:text-slate-300 dark:hover:text-slate-100 dark:hover:bg-slate-600` |

Note: The submit button (lines 90-93) uses `text-white bg-brand-600` / `text-white bg-brand-400` which works in both modes -- no change needed.

#### Body Section (lines 114-174)

| Line | Current Class(es) | Add Dark Variant(s) |
|------|-------------------|---------------------|
| 121 | `text-slate-600` (description paragraph) | `dark:text-slate-400` |
| 128-133 | Textarea -- all 3 branches of the ternary: | |
| | Branch 1 (validation warning): `border-amber-300 bg-amber-50 focus:ring-amber-500` | `dark:border-amber-500 dark:bg-amber-900/20` |
| | Branch 2 (valid/empty): `border-slate-200 focus:ring-brand-500` | `dark:border-slate-600 dark:bg-slate-700 dark:text-white dark:placeholder-slate-400` |
| | Branch 3 (same as 2): `border-slate-200 focus:ring-brand-500` | `dark:border-slate-600 dark:bg-slate-700 dark:text-white dark:placeholder-slate-400` |
| 155 | `bg-amber-50 border-amber-200` (validation warning banner) | `dark:bg-amber-900/20 dark:border-amber-700` |
| 156 | `text-amber-600` (AlertCircle icon) | `dark:text-amber-400` |
| 157 | `text-amber-700` (warning text) | `dark:text-amber-300` |
| 166 | `bg-emerald-50 border-emerald-200` (success banner) | `dark:bg-emerald-900/20 dark:border-emerald-700` |
| 167 | `text-emerald-600` (CheckCircle icon) | `dark:text-emerald-400` |
| 168 | `text-emerald-700` (success text) | `dark:text-emerald-300` |

### Code to Reuse
- No code to reuse from other files. This is purely adding Tailwind `dark:` class variants.

### Code to Modify
- `/home/sanjay/Workspace/onboarding/src/components/modals/SuggestEditModal.tsx`: Add `dark:` variants to ~12 className locations

### Patterns to Follow
- Follow exact dark mode pattern from `CreateOnboardingModal.tsx` (43 dark: classes)
- Use `/20` opacity suffix for dark banner backgrounds (e.g., `dark:bg-amber-900/20`)
- Use `-700` for dark border variants, `-300` to `-400` for dark text variants

## Constraints

### Performance
- No performance impact -- purely CSS class additions
- No new JS logic

### Platform
- Tailwind `darkMode: 'class'` -- well-supported in all browsers
- No SSR concerns (Vite SPA)

### Dependencies
- No new dependencies
- No changes to ModalWrapper (already has dark mode)

## Risk Assessment

### Technical Risks
| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| Missing a `dark:` class somewhere | Low | Low | Exhaustive line-by-line audit already done |
| Breaking light mode appearance | Medium | Very Low | Only adding `dark:` prefixed classes -- they have zero effect in light mode |
| Ternary expression branches diverging | Low | Low | Verified all 3 textarea ternary branches documented |

### Complexity
- **Level:** Simple
- **Rationale:** Pure CSS-class-addition task. No logic changes. No state changes. No new components. One file. Well-established pattern from 3 reference components.

## Open Questions

No open questions. All requirements are clear from:
1. User report (textarea text invisible in dark mode)
2. Codebase audit (zero dark: classes)
3. Reference components (exact pattern to follow)

## Related Dark Mode Bugs (Bugs #22-27)

These are the other dark mode bugs from STATUS.md. They are NOT in scope for this fix but share the same root cause (components written before dark mode was added):

| Bug # | Component | File | `dark:` count | Priority |
|-------|-----------|------|---------------|----------|
| 22 | KPISection | `src/components/manager/KPISection.tsx` | 0 | P1 HIGH |
| 23 | ReportStuckModal | `src/components/modals/ReportStuckModal.tsx` | 0 | P1 HIGH |
| 24 | DeleteConfirmDialog | `src/components/templates/DeleteConfirmDialog.tsx` | 0 | P1 HIGH |
| 25 | ActionBar | `src/components/onboarding/ActionBar.tsx` | 0 | P1 HIGH |
| 26 | StepTimeline | `src/components/onboarding/StepTimeline.tsx` | 0 | P1 HIGH |
| 27 | WelcomeHeader | `src/components/onboarding/WelcomeHeader.tsx` | 0 | P2 MEDIUM |

**Note:** All 7 dark mode bugs (21-27) have the exact same fix pattern: add `dark:` Tailwind class variants. They could potentially be batched into a single implementation pass to save pipeline overhead, though each should be verified independently.

## Recommended Approach

### Implementation Strategy
1. **Single-file edit** of `src/components/modals/SuggestEditModal.tsx`
2. Add `dark:` class variants to every className string that uses light-only colors
3. Follow the exact pattern from `CreateOnboardingModal.tsx` (the most thoroughly dark-mode-styled reference modal)
4. The textarea ternary has 3 branches (warning, valid, default) -- all 3 need dark variants added to the shared classes at the top of the ternary, plus branch-specific dark variants

### Order of Work
1. Add dark mode classes to the textarea (lines 128-134) -- this is the CRITICAL fix
2. Add dark mode classes to the description text (line 121)
3. Add dark mode classes to the validation warning banner (lines 155-161)
4. Add dark mode classes to the success banner (lines 166-171)
5. Add dark mode classes to the footer: character count (line 66), warning text (line 71), Cancel button (line 82)

### What to Defer
- Bugs #22-27 (other dark mode issues) -- fix separately or batch after this one
- No tests exist for SuggestEditModal -- creating visual/snapshot tests could be done as a separate task. For this fix, manual Playwright visual verification is sufficient.

### Estimated Effort
- **Time:** ~15 minutes implementation
- **Lines changed:** ~12 className modifications in 1 file
- **Risk of regression:** Minimal (only adding `dark:` prefixed classes)

## Files That Need Changes

| File | Change Description |
|------|-------------------|
| `/home/sanjay/Workspace/onboarding/src/components/modals/SuggestEditModal.tsx` | Add `dark:` Tailwind class variants to ~12 className locations |

## Next Step

**All questions resolved.** Run `/plan darkmode-suggest-edit` to create implementation plan.
